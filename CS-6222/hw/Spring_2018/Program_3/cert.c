#include <stdio.h>
#include <openssl/bn.h>

#define NBITS 256

void printBN(char *msg, BIGNUM * a) {
	char * number_str = BN_bn2hex(a);
	printf("%s %s\n", msg, number_str);
	OPENSSL_free(number_str);
}

int main() {

	BN_CTX *ctx = BN_CTX_new();

	BIGNUM *n = BN_new();
	BIGNUM *e = BN_new();
	BIGNUM *body = BN_new();
	BIGNUM *signature = BN_new();
	BIGNUM *verify = BN_new();	

	BN_hex2bn(&n, "9C2A04775CD850913A06A382E0D85048BC893FF119701A88467EE08FC5F189CE21EE5AFE610DB7324489A0740B534F55A4CE826295EEEB595FC6E1058012C45E943FBC5B4838F453F724E6FB91E915C4CFF4530DF44AFC9F54DE7DBEA06B6F87C0D0501F28300340DA0873516C7FFF3A3CA737068EBD4B1104EB7D24DEE6F9FC3171FB94D560F32E4AAF42D2CBEAC46A1AB2CC53DD154B8B1FC819611FCD9DA83E632B8435696584C819C54622F85395BEE3804A10C62AECBA972011C739991004A0F0617A95258C4E5275E2B6ED08CA14FCCE226AB34ECF46039797037EC0B1DE7BAF4533CFBA3E71B7DEF42525C20D35899D9DFB0E1179891E37C5AF8E7269");
	BN_hex2bn(&e, "10001");
	BN_hex2bn(&body, "22becc7bae9d6737a3ba8a45f82398cf4617c1ceccde497613a9bbe04179dcf6");
	BN_hex2bn(&signature, "5c107b267de7e8715dd370c8273db59d1fdf533e9cf67adccdbb05a66cfad68a8ee3bb3e42f3b30d7b82b99651299570f5fd4de075bd6c026c928c02282210bf5025de5a5b328d7ee41052f241aba22c90bf05398a2e2b87fe5ffc2a4acc5470e8912ca3a83d955e5c02dc209bc9f15b21c5baf6df9a30031033bfc0f6b84c00de4a47edbfcadf5c710cdbf12b4a83d3f71d331105ef2cdd7f7dae8b39cd3434fb9c6174a317a70da629257062a68cdcf4282c95361487f52e96f61e8e32221b91ace885ebbac503c5291754461a9d1f33656134db9d82626d5267c66e6708a36e82937048b8af15afd5064368e16363197e97c1566bae98a161aad195e38503");

	// verify S^e mod n
	BN_mod_exp(verify, signature, e, n, ctx);
	printBN("verfication: ", verify);
	printBN("original body: ", body);

	return 0;
}